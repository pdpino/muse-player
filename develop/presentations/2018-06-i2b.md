# Presentación socvis

01 junio 2018

## Esquema

1. BCI
2. Muse
3. DIY

## Hablado

* BCI
  - qué es
    Qué es BCI, Brain Computer Interface. Muy a grandes rasgos, lo que hace es: desde el cerebro mandar acciones (o sólo actividad cerebral) a un computador, y este puede mandar feedback de vuelta. Es una forma de comunicar directamente el cerebro con el computador. Esto tiene varias aplicaciones, por ejemplo en personas con alguna discapacidad que puedan aprovechar la tecnología para ayudarlos en actividades diarias.

  - Objetivo
    Entonces, después de la introducción del profe, lo que queremos es integrar un dispositivo BCI a la plataforma moodplay. Mejorar la recomendación utilizando información de la actividad cerebral.

  - Idea: secuencia
    Una idea que tenemos es recomendar secuencias de artistas a un usuario para cambiar su estado de ánimo. Por ejemplo, pensemos que un usuario está con cierto estado de ánimo en una parte del mapa de moodplay. Luego podemos querer recomendarle un artista para que se mueva hacia acá, para después llegar a otro estado de ánimo acá. Queremos poder trazar un camino en base a recomendaciones seguidas, todo sabiendo el estado de ánimo de la persona.

  - Estado inicial
    Bueno para esto, tenemos que partir encontrando el estado mental inicial de la persona. Tenemos que ser capaces de a partir de la actividad cerebral detectar en qué parte del mapa está la persona.

  - fMRI vs EEG
    Para que se hagan una idea, existen varias formas de medir la actividad cerebral. Dos típicas son fMRI y EEG. fMRI por un lado mide potenciales magnéticos y capta cambios en puntos específicos del cerebro. Se mide metiendo a una persona a estas máquinas que ven acá. Por otra parte, EEG mide potenciales eléctricos, capta actividad agregada. Las mediciones se hacen con sensores en la superficie, como se muestra acá, donde cada sensor es un canal.

  - Dispositivos EEG
    Existen muchos dispositivos EEG, desde uso comercial para el público, como este con un canal y cuesta alrededor de 100 dólares. Está el emotiv, que tiene versiones de 5 o 14 canales, y el precio va entre 300 y 800 dólares. Y tenemos de uso de laboratorio, con precios mucho mayores y llegan hasta 256 canales. Entre estos dos está el Muse ...

* Muse
  - intro
    ... un dispositivo EEG de uso comercial, y está pensado para ayudar a las personas a meditar. Viene con una app de celular. Lo que hacen es detectar qué tan relajado estás y te dan feedback para que medites. Por ejemplo si estás relajado te muestran un paisaje como este, y te ponen sonido de fondo de mar o algo por el estilo. Si no estás tan relajado, te ponen sonido de fondo de tormenta.

  - Canales
    Tiene como una forma de cintillo, se pone así como en la foto. Tiene 4 canales. Esta es una cabeza mirada desde arriba, los canales son los que están marcados con celeste. O sea tiene 2 canales en la frente y 2 canales detrás de las orejas.

  - versiones
    Hay dos versiones del dispositivo: 2014 y 2016. La versión 2014 viene con un programa para captar ondas sin escribir código (te permite conectarte, grabar ondas, etc), hecho para investigación, e incluso con una librería para poder captar las cosas en C#. La versión 2016... no tiene nada. A final del año pasado salió una herramienta de visualización, pero está sólo para windows y no es tan buena. Cuando empezamos con esto no había nada, así que tuvimos que partir de 0.

  - software
    Así que el software que hemos desarrollado tiene la siguiente arquitectura. Tenemos el muse que envía datos por bluetooth, los datos se manejan con python y se envían procesados a javascript para visualizarse.
    Yo hice una página en javascript que visualiza los datos, como veremos en la demo, pero la gracia es que podemos cambiar esto por el moodplay después.
    En python finalmente encontré un repositorio de un francés que descifró lo básico del bluetooth del muse, así que pude partir de ahí.

  - demo
    Ahora pasaremos a una demo en vivo con el dispositivo

* Ondas
  - señal es ruidosa
    Señal cruda es ruidosa, así que es útil hacer un análisis de frecuencia de la señal. Alguien sabe sobre procesamiento de señales? Voy a explicar algo muy básico de eso.

  - composición de ondas
    Por ejemplo, ahí tenemos dos ondas simples, la de arriba de 4 Hz y baja potencia y la de abajo de 10 Hz y mayor potencia. Si sumamos las ondas, se obtiene esta onda, que se ve menos simple que las anteriores. Lo que hacemos entonces es analizar sus frecuencias, representar la onda así: en el eje x está la frecuencia y en el eje y la potencia. Entonces tenemos que esta onda se compone de 2 ondas, justamente una de 4 Hz y otra de 10 Hz, y una de mayor potencia que la otra. Lo que se obtiene de EEG es algo como esto, pero con muchas más ondas sumadas, y lo queremos descomponer

  - fourier
    Tenemos una onda de EEG y la queremos descomponer. Para eso tomamos una ventana y aplicamos una transformación de fourier, que nos da un gráfico como el anterior. Así podemos ver la distribución de frecuencias de esa ventana de la onda.
    La idea ahora es mover la ventana a través de la onda y obtener varios de estos gráficos, y colocarlos de la siguiente manera.

  - fourier 2 (topoplot)
    Se colocan en este plot con 3 dimensiones. En el eje x tenemos el tiempo, en el eje y la frecuencia, y en el eje z (el color) la potencia. Este proceso se conoce como "short-time fast fourier transform". Cómo leer esto: por ejemplo tomamos un rango de frecuencia que nos interese: por ej entre 8 y 18 Hz, y vemos que más o menos en el segundo 25 hubo un aumento de la potencia en esa banda, porque se puso más amarillo.

  - ondas conocidas
    La gracia es que en al literatura definen estas bandas de frecuencias conocidas, delta, theta, alpha, beta, gamma. Cada una tiene su rango de frecuencias, y se ha estudiado con qué cosas están relacionadas. Por ejemplo si el cerebro tiene mucha actividad en alpha puede estar relajado, en beta concentrado, etc. En el mismo gráfico de antes vemos que hubo un aumento en alpha en el segundo 25, y también un poco en beta.

  - normalización
    Cabe mencionar algo acá. Estamos trabajando con frecuencias, y en general la potencia de las ondas de menor frecuencia es mayor. O sea la potencia baja para frecuencias más altas. Qué pasa con esto? Si tomamos la banda alpha siempre tendrá más potencia que la beta. Entonces, hay que hacer una normalización. Básicamente lo que se hace es tomar un periodo de tiempo de baseline, promediarlo (o mediana) para obtener un valor. Y luego todos los datos dividirlos por eso. Esto debe hacerse por frecuencia.

  - demo 2: ondas
    Pasaremos a una demo.

* Estado mental
  - Mapeo
    Ahora queremos pasar de los datos EEG a otro dominio, a un dominio de estado mental. Queremos lograr detectar en qué estado de ánimo está la persona.

  - opciones mapeo
    Aquí tenemos varias opciones. Una opción es pasar directo al dominio del moodplay, que tiene estas 3 categorías principales de emoción. No es claro cómo hacerlo. Tenemos el modelo valence-arousal, que tiene en el eje x positiva o negativa, y en el eje y: activo o pasivo. Por ejemplo, en la parte de acá tenemos Happy, que es positiva y no tan activa. Por acá tenemos Angry, que es negativa y activa, y así sucesivamente. Este es un modelo que se usa mucho en la literatura en distintos ámbitos. Por último se nos ocurrió partir con esta idea más simple, detectar nivel de relajación y concentración, con las ondas conocidas que les mostré antes.

  - fórmula valence-arousal
    Encontramos una fórmula para calcular valence-arousal en un paper, que incluía tomar la onda alpha y beta de dos canales específicos, la probamos un poco y no nos ha funcionado muy bien.

  - Dominio relajación-concentración
    Así que decidimos partir por algo más simple. Guíandonos por lo que les mencioné antes de las ondas conocidas partimos con esta idea de concentración y relajación. Medimos con las onda beta de los canales de la frente una medición para la concentración de la persona. Por otro lado, tomamos las onda alpha de los dos canales de atrás para medir relajación.

  - Demo video
    Les vamos a mostrar un video de un experimento que hicimos con el profe, en donde se concentra para leer y medimos las ondas cerebrales.

    Opción demo live

  - Mapeo moodplay
    Esto hay que mapearlo a moodplay. Primero transformamos los valores anteriores a un porcentaje, de manera de tener una probabilidad de qué tan relajado está. Y para mapearlo no tenemos un mapeo robusto aún, pero partimos con algo simple. Tiramos una recta entre sublimity y vitality, hacia sublimity relajación y hacia arriba a la derecha concentración.

  - demo con moodplay
    Pasaremos a la 4ta y última demo

* Desafíos
  Bueno, les mostramos el trabajo que está en pleno proceso, tenemos hartos desafíos que cumplir
  Remover el ruido, como vieron la señal tiene mucho ruido y afecta todos los cálculos.
  Estudiar bien cómo mapear la señal EEG a un dominio de emoción, queremos un método robusto, y hay que definir un buen método para usar.
  Integrar la interfaz de usuario con una buena visualización.


3. DYI
  - Para los que quedaron con las ganas de hacer algo ustedes mismos, les traemos un bonus en la presentación. La parte "hágalo usted mismo". Existe una librería para python llamada MNE, que provee muchas herramientas para manejar datos EEG. Herramientas de preprocesamiento, visualización, análisis de frecuencia, métodos de machine learning y muchas otras cosas. Es desarrollada y mantenida por hartos académicos, unos de Harvard, otros de una universidad de Francia, entre otros.

  - gráficos
    Con esta librería se pueden hacer gráficos como estos de manera super simple. Por ejemplo aquí tenemos una onda EEG promediada en el tiempo, aquí tenemos mapas de activación de las partes del cerebro que se activaron en distintos momentos. Tenemos otro gráfico con la misma idea pero en 3d.

  - Dataset
    Por un lado tenemos las herramientas de código, y por otro lado también hay bases de datos disponibles. Nosotros estamos empezando a usar una base de datos, llamada DEAP, que fue creada en un estudio con EEG y emoción. Se puso a participantes a mirar un video de 60 segundos, mientras se les grababa un video de la cara y las ondas EEG. Luego cada participante evaluaba la emoción que sintió durante el video, en el modelo de valence-arousal que les mostré antes.
    Aquí usaron 32 canales EEG, bastante más que los que tiene el Muse, y además grabaron otras señales periféricas.

  - Canales
    Esta es una imagen del paper que muestra los sensores que usaron.
